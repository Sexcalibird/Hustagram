{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport axios from 'axios';\nimport { useRefreshToken } from \"../hooks\";\nimport { getToken } from \"../redux/authSlice\";\nimport { useSelector } from \"react-redux\";\nconst BASE_URL = 'http://localhost:8080';\nexport default axios.create({\n  baseURL: BASE_URL\n});\nexport const axiosPrivate = axios.create({\n  baseURL: BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  withCredentials: true\n});\n_s(axiosPrivate.interceptors.request.use(_s(config => {\n  _s();\n  if (!config.headers['Authorization']) {\n    config.headers['Authorization'] = `Bearer ${useSelector(getToken)}`;\n  }\n  return config;\n}, \"nKHvd/QB6hocKEk0fSJoSYcCyR8=\", false, function () {\n  return [useSelector];\n}), error => Promise.reject(error)), \"nKHvd/QB6hocKEk0fSJoSYcCyR8=\", false, function () {\n  return [useSelector];\n});\n_s2(axiosPrivate.interceptors.response.use(response => response, _s2(async error => {\n  var _error$response;\n  _s2();\n  const prevRequest = error === null || error === void 0 ? void 0 : error.config;\n  if ((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 403 && !(prevRequest !== null && prevRequest !== void 0 && prevRequest.sent)) {\n    prevRequest.sent = true;\n    const newAccessToken = await useRefreshToken();\n    prevRequest.headers['Authorization'] = `Bearer ${newAccessToken}`;\n    return axiosPrivate(prevRequest);\n  }\n  return Promise.reject(error);\n}, \"PezjRBTCyuPEZSNJO+/qPK5Btmo=\", false, function () {\n  return [useRefreshToken];\n})), \"PezjRBTCyuPEZSNJO+/qPK5Btmo=\", false, function () {\n  return [useRefreshToken];\n});","map":{"version":3,"names":["axios","useRefreshToken","getToken","useSelector","BASE_URL","create","baseURL","axiosPrivate","headers","withCredentials","interceptors","request","use","config","error","Promise","reject","response","prevRequest","status","sent","newAccessToken"],"sources":["C:/Users/ADMIN/IdeaProjects/datn/client/src/axios/axios.js"],"sourcesContent":["import axios from 'axios';\r\nimport {useRefreshToken} from \"../hooks\";\r\nimport {getToken} from \"../redux/authSlice\";\r\nimport {useSelector} from \"react-redux\";\r\n\r\nconst BASE_URL = 'http://localhost:8080';\r\n\r\nexport default axios.create({\r\n    baseURL: BASE_URL,\r\n});\r\n\r\n\r\nexport const axiosPrivate = axios.create({\r\n    baseURL: BASE_URL,\r\n    headers: { 'Content-Type': 'application/json' },\r\n    withCredentials: true\r\n});\r\naxiosPrivate.interceptors.request.use(\r\n    config => {\r\n        if (!config.headers['Authorization']) {\r\n            config.headers['Authorization'] = `Bearer ${useSelector(getToken)}`;\r\n        }\r\n        return config;\r\n    }, (error) => Promise.reject(error)\r\n);\r\naxiosPrivate.interceptors.response.use(\r\n    response => response,\r\n    async (error) => {\r\n        const prevRequest = error?.config;\r\n        if (error?.response?.status === 403 && !prevRequest?.sent) {\r\n            prevRequest.sent = true;\r\n            const newAccessToken = await useRefreshToken();\r\n            prevRequest.headers['Authorization'] = `Bearer ${newAccessToken}`;\r\n            return axiosPrivate(prevRequest);\r\n        }\r\n        return Promise.reject(error);\r\n    }\r\n);"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAAQC,eAAe,QAAO,UAAU;AACxC,SAAQC,QAAQ,QAAO,oBAAoB;AAC3C,SAAQC,WAAW,QAAO,aAAa;AAEvC,MAAMC,QAAQ,GAAG,uBAAuB;AAExC,eAAeJ,KAAK,CAACK,MAAM,CAAC;EACxBC,OAAO,EAAEF;AACb,CAAC,CAAC;AAGF,OAAO,MAAMG,YAAY,GAAGP,KAAK,CAACK,MAAM,CAAC;EACrCC,OAAO,EAAEF,QAAQ;EACjBI,OAAO,EAAE;IAAE,cAAc,EAAE;EAAmB,CAAC;EAC/CC,eAAe,EAAE;AACrB,CAAC,CAAC;AACF,GAAAF,YAAY,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,IACjCC,MAAM,IAAI;EAAA;EACN,IAAI,CAACA,MAAM,CAACL,OAAO,CAAC,eAAe,CAAC,EAAE;IAClCK,MAAM,CAACL,OAAO,CAAC,eAAe,CAAC,GAAI,UAASL,WAAW,CAACD,QAAQ,CAAE,EAAC;EACvE;EACA,OAAOW,MAAM;AACjB,CAAC;EAAA,QAHmDV,WAAW;AAAA,IAG3DW,KAAK,IAAKC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CACtC;EAAA,QAJuDX,WAAW;AAAA;AAKnE,IAAAI,YAAY,CAACG,YAAY,CAACO,QAAQ,CAACL,GAAG,CAClCK,QAAQ,IAAIA,QAAQ,MACpB,MAAOH,KAAK,IAAK;EAAA;EAAA;EACb,MAAMI,WAAW,GAAGJ,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAED,MAAM;EACjC,IAAI,CAAAC,KAAK,aAALA,KAAK,0CAALA,KAAK,CAAEG,QAAQ,oDAAf,gBAAiBE,MAAM,MAAK,GAAG,IAAI,EAACD,WAAW,aAAXA,WAAW,eAAXA,WAAW,CAAEE,IAAI,GAAE;IACvDF,WAAW,CAACE,IAAI,GAAG,IAAI;IACvB,MAAMC,cAAc,GAAG,MAAMpB,eAAe,EAAE;IAC9CiB,WAAW,CAACV,OAAO,CAAC,eAAe,CAAC,GAAI,UAASa,cAAe,EAAC;IACjE,OAAOd,YAAY,CAACW,WAAW,CAAC;EACpC;EACA,OAAOH,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CAAC;EAAA,QALoCb,eAAe;AAAA,GAMvD;EAAA,QANwCA,eAAe;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}